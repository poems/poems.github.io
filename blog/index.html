
<!DOCTYPE HTML>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<title>Young & Foolish  | POEMS</title>

	<meta name="author" content="Pieux Xi">

<meta name="description" content="å‡è®¾ CAS Server çš„åŸŸåæ˜¯ cas.server.com CAS Server çš„ webapp æ˜¯ spring web flowï¼Œç™»é™†åœ°å€ä¸ºï¼šhttps://cas.server.com/cas/login ç™»å‡ºå &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="POEMS" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	

</head>



<body>
	<header id="header" class="inner"><h1><a href="/">POEMS</a></h1>
<span class="tagline">Young & Foolish</span>
<!-- <nav id="main-nav"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav> -->
<!-- <nav id="mobile-nav"> -->
<!-- 	<div class="alignleft menu"> -->
<!-- 		<a class="button">Menu</a> -->
<!-- 		<div class="container"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</div> -->
<!-- 	</div> -->
<!-- </nav> -->


</header>

	<div id="content" class="inner">


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/12/08/note-everything-about-cas/">
			
				NOTE: Everything About CAS</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-12-08T02:12:00+00:00" pubdate data-updated="true">Dec 8<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<p>å‡è®¾ CAS Server çš„åŸŸåæ˜¯ cas.server.com</p>

<p>CAS Server çš„ webapp æ˜¯ spring web flowï¼Œç™»é™†åœ°å€ä¸ºï¼š<a href="https://cas.server.com/cas/login">https://cas.server.com/cas/login</a></p>

<p>ç™»å‡ºåœ°å€ä¸ºï¼š<a href="https://cas.server.com/cas/logout">https://cas.server.com/cas/logout</a></p>

<p>è¯­è¨€å‚æ•°ä¸ºï¼šlocale=zh_CNï¼Œlocale=en</p>

<p>é™¤äº†é…ç½® CAS Server å’Œ Client å¤–ï¼Œéœ€è¦é…ç½®ç¯å¢ƒï¼ŒåŒ…æ‹¬ç”Ÿæˆå’Œå¯¼å‡ºå¯¼å…¥è¯ä¹¦ï¼ŒTomcaté…ç½®SSLç­‰ã€‚</p>

<h2>CAS Server</h2>

<h3>åŸç†ï¼ˆè®¤è¯æµç¨‹ï¼‰</h3>

<p><img src="http://i.imgur.com/MDSRTIc.jpg" alt="CAS åŸºæœ¬æ¨¡å¼" /></p>

<p><strong>åŸç†</strong>ï¼šæŒ‰ç…§æ­¤å›¾æ¥è¯´</p>

<ol>
<li><p>ç”¨æˆ·è®¿é—®CAS Client</p></li>
<li><p>å…¶é…ç½®çš„ AuthenticationFilter ä¼šæ‹¦æˆªæ­¤è¯·æ±‚ï¼Œç”Ÿæˆ service å‚æ•°ï¼Œå¹¶é‡å®šå‘åˆ° CAS Server çš„ç™»é™†æ¥å£ï¼Œurlä¸º <a href="https://cas.server.com/login?service=redirect_url">https://cas.server.com/login?service=redirect_url</a></p></li>
<li><p>ç”¨æˆ·åœ¨ CAS Server è¾“å…¥ Credentials(ä¸€èˆ¬å°±æ˜¯ç”¨æˆ·åå’Œå¯†ç )è¿›è¡Œèº«ä»½éªŒè¯ï¼ŒæˆåŠŸåï¼ŒCAS Server ä¼šç”Ÿæˆè®¤è¯ cookieï¼Œå³TGCã€‚ï¼ˆå¦ï¼šTGCä½œä¸º cookieä¹‹å¤–ï¼Œä¹Ÿä¼šæ¢å­˜åœ¨æœåŠ¡å™¨æœ¬åœ°ï¼Œæˆ‘çŒœæµ‹æ˜¯ä¸æ˜¯æœåŠ¡å™¨è¿è¡Œå®ä¾‹çš„å†…å­˜ä¸­ã€‚ï¼‰</p></li>
<li><p>CAS Serverè¿˜ä¼šæ ¹æ® service å‚æ•°ï¼Œç”Ÿæˆ Ticketï¼Œå³STã€‚STä¼šä¿å­˜åœ¨æœåŠ¡å™¨ï¼Œä¹Ÿä¼šåŠ åœ¨ url åé¢ï¼Œé‡å®šå‘å› clientã€‚urlä¸º <a href="http://client_server_url:port/app_name?ticket=ST-*-*">http://client_server_url:port/app_name?ticket=ST-*-*</a></p></li>
<li><p>Client çš„ AuthenticationFilter çœ‹åˆ° ticket å‚æ•°åï¼Œä¼šè·³è¿‡ï¼Œäº¤ç”±åé¢çš„ TicketValidationFilter æ¥å¤„ç†ã€‚TicketValidationFilter ä¼šåˆ©ç”¨ httpclient å·¥å…·è®¿é—® cas server çš„ /serviceValidate æ¥å£ï¼Œå°† ticket, service ä¼ å…¥è¯¥æ¥å£ï¼ŒéªŒè¯ ticket çš„æœ‰æ•ˆæ€§ã€‚</p></li>
<li><p>å¦‚æœè¿”å›éªŒè¯æˆåŠŸï¼Œå°±ä¼šæŠŠç”¨æˆ·ä¿¡æ¯å†™å…¥ client çš„ session é‡Œã€‚</p></li>
</ol>


<p>è‡³æ­¤ï¼ŒSSO ä¼šè¯å°±å»ºç«‹èµ·æ¥äº†ã€‚</p>

<p>ç»“æœå°±æ˜¯ï¼š</p>

<ol>
<li><p>ç”¨æˆ·åœ¨åŒä¸€æµè§ˆå™¨è®¿é—®åŒä¸€ clientï¼Œä¸ä¼šå» CAS Server è®¤è¯ï¼Œå› ä¸º AuthenticationFilter ä¼šåœ¨ session è¯»å–åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚</p></li>
<li><p>ç”¨æˆ·åœ¨åŒä¸€æµè§ˆå™¨è®¿é—®å…¶ä»– clientï¼ŒAuthenticationFilter åœ¨ session é‡Œè¯»ä¸åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œä¼šå» cas login æ¥å£è®¤è¯ï¼Œä½†æ˜¯æ­¤æ—¶ cas login æ¥å£ä¼šè¯»å–åˆ°å­˜å‚¨åœ¨cas serveråŸŸåä¸‹çš„ TGCï¼Œæ‰€ä»¥ï¼ŒCAS Serverä¸ä¼šè·³åˆ°ç™»å½•é¡µï¼Œåªä¼šæ ¹æ® service å‚æ•°ç”Ÿæˆä¸€ä¸ª ticketï¼Œä¼ ç»™ clientã€‚ç„¶åç”±TicketValidationFilteråšä¸€æ¬¡äº¤äº’éªŒè¯ã€‚</p></li>
</ol>


<h3>CAS Server æä¾›çš„æ¥å£</h3>

<p>cas server ä¸€å…±å®šä¹‰äº†9ä¸ªæ¥å£ã€‚client ä¼šé€šè¿‡ url redirect å’Œ httpclient çš„æ–¹å¼å’Œ server äº¤äº’ã€‚</p>

<table>
<thead>
<tr>
<th align="center">æ¥å£ </th>
<th align="left"> è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">/login        </td>
<td align="left"> è®¤è¯æ¥å£</td>
</tr>
<tr>
<td align="center">/logout       </td>
<td align="left"> é€€å‡ºæ¥å£ï¼Œé”€æ¯ TGC</td>
</tr>
<tr>
<td align="center">/validate     </td>
<td align="left"> éªŒè¯ ticket æ¥å£ï¼ŒCAS1.0</td>
</tr>
<tr>
<td align="center">/serviceValidate </td>
<td align="left"> åŒä¸Šï¼ŒCAS2.0</td>
</tr>
<tr>
<td align="center">/proxy        </td>
<td align="left"> æ”¯æŒä»£ç†åŠŸèƒ½çš„æ¥å£</td>
</tr>
<tr>
<td align="center">/proxyValidate </td>
<td align="left"> åŒä¸Š</td>
</tr>
<tr>
<td align="center">/CentralAuthenticationService </td>
<td align="left"> ç”¨äºå’Œè¿œç¨‹çš„ web services äº¤äº’</td>
</tr>
<tr>
<td align="center">/remoteLogin  </td>
<td align="left"> è®¤è¯æ¥å£ï¼ˆæ–°å¢ï¼‰</td>
</tr>
<tr>
<td align="center">/directLogin  </td>
<td align="left"> è®¤è¯æ¥å£ï¼ˆæ–°å¢ï¼‰</td>
</tr>
</tbody>
</table>


<h2>è®¤è¯ç›¸å…³çš„æœ¯è¯­</h2>

<ul>
<li><p><strong>Credentials</strong> ç”¨æˆ·æä¾›çš„å‡­è¯ï¼Œæ¯”å¦‚ ç”¨æˆ·å/å¯†ç ï¼Œè¯ä¹¦ï¼ŒIPåœ°å€ï¼ŒCookieå€¼ç­‰ã€‚</p></li>
<li><p><strong>AuthenticationHandler</strong> è®¤è¯Handlerï¼Œæ¯”å¦‚ï¼šAbstractUsernamePasswordAuthenticationHandler è´Ÿè´£å¤„ç† UsernamePasswordCredentials.</p></li>
<li><p><strong>CredentialsToPrincipalResolvers</strong> è´Ÿè´£ç”± Credentials ç”Ÿæˆ Principal å¯¹è±¡ï¼Œæ¯ç§ CredentialsToPrincipalResolvers åªå¤„ç† ä¸€ç§Credentials ï¼Œæ¯”å¦‚ UsernamePasswordCredentialsToPrincipalResolver è´Ÿè´£ä» UsernamePasswordCredentials ä¸­å–å‡ºç”¨æˆ·åï¼Œç„¶åå°†å…¶èµ‹ç»™ç”Ÿæˆçš„ SimplePrincipal çš„ ID å±æ€§ã€‚</p></li>
<li><p><strong>AuthenticationMetaDataPopulators</strong> è´Ÿè´£å°† Credentials çš„ä¸€äº›å±æ€§èµ‹å€¼ç»™ Authentication çš„ attributes å±æ€§ã€‚</p></li>
<li><p><strong>Authentication</strong>  Authenticationæ˜¯è®¤è¯ç®¡ç†å™¨çš„æœ€ç»ˆå¤„ç†ç»“æœï¼Œ Authentication å°è£…äº† Principal ï¼Œè®¤è¯æ—¶é—´ï¼ŒåŠå…¶ä»–ä¸€äº›å±æ€§ï¼ˆå¯èƒ½æ¥è‡ª Credentialsï¼‰ã€‚</p></li>
<li><p><strong>AuthenticationManager</strong> è®¤è¯ç®¡ç†å™¨å¾—åˆ° Credentials å¯¹è±¡åï¼Œè´Ÿè´£è°ƒåº¦AuthenticationHandler å»å®Œæˆè®¤è¯å·¥ä½œï¼Œæœ€åè¿”å›çš„ç»“æœæ˜¯ Authentication å¯¹è±¡ã€‚</p></li>
<li><p><strong>CentralAuthenticationService</strong> CAS çš„æœåŠ¡ç±»ï¼Œå¯¹ Web å±‚æä¾›äº†ä¸€äº›æ–¹æ³•ã€‚è¯¥ç±»è¿˜è´Ÿè´£è°ƒç”¨ AuthenticationManager å®Œæˆè®¤è¯é€»è¾‘ã€‚</p></li>
</ul>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/12/08/maven-archetype-plugin/">
			
				Maven Archetype Plugin</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-12-08T01:31:00+00:00" pubdate data-updated="true">Dec 8<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<h2>Struts 2 Maven Archetype</h2>

<h3>The Blank Archetype (struts2-archetype-blank)</h3>

<h3>The Starter Archetype (struts2-archetype-starter)</h3>

<p>Compared to the former, it adds more features like &ldquo;Spring Integration&rdquo;.</p>

<h3>The Blank Convention Archetype (struts2-archetype-convention)</h3>

<p>Features like &ldquo;Convention-based validation&rdquo;, &ldquo;GAE aware&rdquo;.</p>

<h2>Creating an Application Using a Maven Archetyp</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn archetype:generate -B \
</span><span class='line'>                       -DgroupId=tutorial \
</span><span class='line'>                       -DartifactId=tutorial \
</span><span class='line'>                       -DarchetypeGroupId=org.apache.struts \
</span><span class='line'>                       -DarchetypeArtifactId=struts2-archetype-blank \
</span><span class='line'>                       -DarchetypeVersion=&lt;version&gt;</span></code></pre></td></tr></table></div></figure>


<p>If the above command will fail because of missing archetypes in central repository, you can try to use staging repository like below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn archetype:generate -DarchetypeCatalog=http://people.apache.org/builds/struts/&lt;version&gt;/m2-staging-repository/</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/12/05/note-cas-java-client/">
			
				NOTE: CAS Java Client</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-12-05T08:43:00+00:00" pubdate data-updated="true">Dec 5<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<h1>CAS Client for Java 3.1</h1>

<h2>é€šè¿‡ web.xml é…ç½® Jasig CAS Client for Java</h2>

<p>CAS Client for Java 3.1/3.2 å¯ä»¥é€šè¿‡é…ç½® web.xml é‡Œçš„ context-params å’Œ filter init-paramsã€‚æ¯ä¸ª filter éƒ½éœ€è¦é…ç½®ä¸€ç³»åˆ—çš„å±æ€§ï¼ˆpropertiesï¼‰ã€‚filters ä¼šæŸ¥æ‰¾è¿™äº›å±æ€§ï¼š</p>

<ol>
<li>é¦–å…ˆæ£€æŸ¥ filter çš„æœ¬åœ° init-paramsï¼ˆlocal init-paramsï¼‰ï¼Œçœ‹æ˜¯å¦æœ‰ç›¸ç¬¦åˆçš„å±æ€§åï¼›</li>
<li>å…¶æ¬¡æ£€æŸ¥ context çš„å‚æ•° ï¼Œçœ‹æ˜¯å¦æœ‰ç›¸ç¬¦åˆçš„å±æ€§åï¼›</li>
</ol>


<p>å¦‚æœåœ¨ filter çš„ init-params å’Œ context çš„å‚æ•°ä¸­æ‰¾åˆ°ç›¸åŒçš„å€¼ï¼Œåˆ™é€‰ç”¨ init-paramsã€‚</p>

<p>åŒæ ·ï¼Œfilter çš„é¡ºåºä¸ºï¼š</p>

<ol>
<li>SingleLogOutFilter (if you&rsquo;re using it)</li>
<li>AuthenticationFilter</li>
<li>TicketValidationFilter (whichever one is chosen)</li>
<li>HttpServletRequestWrapperFilter</li>
<li>AssertionThreadLocalFilter</li>
</ol>


<blockquote><p>! å¦‚æœä½¿ç”¨ serverName å±æ€§ï¼Œè¯·æ³¨æ„ fragment-URL(#åçš„ URL)ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨ã€‚</p></blockquote>

<p>ä¸€ä¸€ä»‹ç»å¯ç”¨çš„ filters:</p>

<h3>org.jasig.cas.client.authentication.AuthenticationFilter</h3>

<p>AuthenticationFilter åˆ¤æ–­ä¸€ä¸ªç”¨æˆ·æ˜¯å¦éœ€è¦éªŒè¯ã€‚å¦‚æœéœ€è¦ï¼Œåˆ™é‡å®šå‘åˆ° CAS serverã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;filter&gt;
</span><span class='line'>  &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
</span><span class='line'>  &lt;filter-class&gt;org.jasig.cas.client.authentication.AuthenticationFilter&lt;/filter-class&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>    &lt;!--cas server login url--&gt;
</span><span class='line'>    &lt;param-name&gt;casServerLoginUrl&lt;/param-name&gt;
</span><span class='line'>    &lt;param-value&gt;https://battags.ad.ess.rutgers.edu:8443/cas/login&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>    &lt;!--cas server name--&gt;
</span><span class='line'>    &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>    &lt;param-value&gt;http://www.acme-client.com&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>&lt;/filter&gt;</span></code></pre></td></tr></table></div></figure>


<p><strong>Required Properties</strong></p>

<ul>
<li>casServerLoginUrl: CAS server çš„ç™»å½•é¡µåœ°å€ï¼Œi.e. <a href="https://localhost:8443/cas/login">https://localhost:8443/cas/login</a></li>
<li>service or serverName

<ul>
<li>service: å‘é€ç»™ CAS server çš„æœåŠ¡çš„ URLï¼Œe.g. <a href="https://localhost:8443/yourwebapp/index.html">https://localhost:8443/yourwebapp/index.html</a></li>
<li>serverName: åº”ç”¨éƒ¨ç½²çš„æœåŠ¡å™¨åã€‚service URL ä¼šæ®æ­¤åŠ¨æ€ç”Ÿæˆã€‚i.e. <a href="https://localhost:8443">https://localhost:8443</a> (éœ€è¦æŒ‡å®šåè®®ï¼Œå¦‚æœæ˜¯æ ‡å‡†ç«¯å£ï¼Œåˆ™ç«¯å£å¯éšå¼)ã€‚</li>
</ul>
</li>
</ul>


<p><strong>Optional Properties</strong>:</p>

<p>æœ‰ <em>renew</em>, <em>gateway</em>, <em>artifactParameterName</em>, <em>serviceParameterName</em>ã€‚</p>

<h3>org.jasig.cas.client.authentication.Saml11AuthenticationFilter</h3>

<p>çŒœæµ‹æ˜¯æ”¯æŒ SAML 1.1 çš„ authentication filterã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;filter&gt;
</span><span class='line'>  &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
</span><span class='line'>  &lt;filter-class&gt;org.jasig.cas.client.authentication.AuthenticationFilter&lt;/filter-class&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>    &lt;param-name&gt;casServerLoginUrl&lt;/param-name&gt;
</span><span class='line'>    &lt;param-value&gt;https://battags.ad.ess.rutgers.edu:8443/cas/login&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>    &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>    &lt;param-value&gt;http://www.acme-client.com&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>&lt;/filter&gt;</span></code></pre></td></tr></table></div></figure>


<h3>org.jasig.cas.client.validation.Saml11TicketValidationFilter</h3>

<p>ä½¿ç”¨ SAML 1.1 åè®®éªŒè¯ ticketsã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;filter&gt;
</span><span class='line'>  &lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
</span><span class='line'>  &lt;filter-class&gt;org.jasig.cas.client.validation.Saml11TicketValidationFilter&lt;/filter-class&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>    &lt;param-name&gt;casServerUrlPrefix&lt;/param-name&gt;
</span><span class='line'>    &lt;param-value&gt;https://battags.ad.ess.rutgers.edu:8443/cas&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>    &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>    &lt;param-value&gt;http://www.acme-client.com&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'> &lt;/filter&gt;</span></code></pre></td></tr></table></div></figure>


<p><strong>Required Properties</strong></p>

<ul>
<li>casServerUrlPrefix: CAS æœåŠ¡å™¨çš„URLèµ·å§‹é¡µï¼Œi.e. <a href="https://localhost:8443/cas">https://localhost:8443/cas</a></li>
<li>serverName or service: åŒä¸Š</li>
</ul>


<p><strong>Optional Properties</strong></p>

<ul>
<li>redirectAfterValidation (default: true)</li>
<li>useSession (default: true)</li>
<li>exceptionOnValidationFailure (default: true)</li>
<li>tolerance (default: 1000 mSec)</li>
<li>renew (default: false)</li>
</ul>


<h3>org.jasig.cas.client.util.HttpServletRequestWrapperFilter</h3>

<p>Wraps an HttpServletRequest so that the getRemoteUser and getPrincipal return the CAS related entries.</p>

<p>åŒ…è£¹ HttpServletRequestï¼Œä½¿ getRemoteUser å’Œ getPrincipal è¿”å› CAS ç›¸å…³çš„å…¥å£ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;filter&gt;
</span><span class='line'>  &lt;filter-name&gt;CAS HttpServletRequest Wrapper Filter&lt;/filter-name&gt;
</span><span class='line'>  &lt;filter-class&gt;org.jasig.cas.client.util.HttpServletRequestWrapperFilter&lt;/filter-class&gt;
</span><span class='line'>&lt;/filter&gt;</span></code></pre></td></tr></table></div></figure>


<p><strong>Required Properties</strong></p>

<p>None</p>

<p><strong>Optional Properties</strong></p>

<p>None</p>

<h3>org.jasig.cas.client.util.AssertionThreadLocalFilter</h3>

<p>Places the Assertion in a ThreadLocal for portions of the application that need access to it. This is useful when the Web application that this filter &ldquo;fronts&rdquo; needs to get the Principal name, but it has no access to the HttpServletRequest, hence making getRemoteUser() call impossible.</p>

<p>æŠŠè¿™ä¸ª Assertion æ”¾è¿› ThreadLocal ä¸­ï¼Œå› ä¸ºæœ‰äº›åº”ç”¨å¯èƒ½éœ€è¦ã€‚æ¯”å¦‚ï¼šå½“ Web åº”ç”¨éœ€è¦æ‹¿åˆ° Principal çš„åå­—ï¼Œä½†æ˜¯å®ƒæ— æ³•è®¿é—® HttpServletRequestï¼Œå› æ­¤ getRemoteUser() æ²¡æœ‰ç”¨ã€‚</p>

<blockquote><p>! æ²¡ææ‡‚ä»€ä¹ˆæ„æ€ï¼ŒçŒœæµ‹æ˜¯ CAS Client åº”ç”¨æƒ³è¦æ‹¿åˆ°ç™»é™†çš„ç”¨æˆ·åï¼Œä½†æ˜¯ç”¨æˆ·åå­˜å‚¨åœ¨ CAS Server ä¸Šã€‚è¿™ä¸ª filter çš„ä½œç”¨å°±æ˜¯æŠŠ Principal æ”¾åˆ° ThreadLocal å˜é‡ä¸­ã€‚</p></blockquote>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;filter&gt;
</span><span class='line'>  &lt;filter-name&gt;CAS Assertion Thread Local Filter&lt;/filter-name&gt;
</span><span class='line'>  &lt;filter-class&gt;org.jasig.cas.client.util.AssertionThreadLocalFilter&lt;/filter-class&gt;
</span><span class='line'>&lt;/filter&gt;</span></code></pre></td></tr></table></div></figure>


<p>e.g. ä¸€ä»½ç¨å®Œæ•´çš„ CAS Client for Java çš„ web.xmlï¼ˆæœªä½¿ç”¨ SAML 1.1ï¼Œä¸º CAS åè®®ï¼‰</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
</span><span class='line'>&lt;web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
</span><span class='line'>    version="2.4"&gt;
</span><span class='line'>
</span><span class='line'>    &lt;display-name&gt;CAS client demo : application&lt;/display-name&gt;
</span><span class='line'>
</span><span class='line'>    &lt;filter&gt;
</span><span class='line'>        &lt;!--é…ç½® AuthenticationFilter--&gt;
</span><span class='line'>        &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
</span><span class='line'>        &lt;filter-class&gt;org.jasig.cas.client.authentication.AuthenticationFilter&lt;/filter-class&gt;
</span><span class='line'>        &lt;init-param&gt;
</span><span class='line'>            &lt;!--property: ç™»é™†é¡µé…ç½®--&gt;
</span><span class='line'>            &lt;param-name&gt;casServerLoginUrl&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;http://localhost:8080/cas/login&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param&gt;
</span><span class='line'>        &lt;init-param&gt;
</span><span class='line'>            &lt;!--property: éƒ¨ç½²æœåŠ¡å™¨åœ°å€--&gt;
</span><span class='line'>            &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param&gt;
</span><span class='line'>        &lt;!-- init-param&gt;
</span><span class='line'>            &lt;param-name&gt;service&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;http://localhost:8080/default.jsp&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param--&gt;
</span><span class='line'>    &lt;/filter&gt;
</span><span class='line'>
</span><span class='line'>    &lt;filter&gt;
</span><span class='line'>        &lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
</span><span class='line'>        &lt;filter-class&gt;org.jasig.cas.client.validation.Cas10TicketValidationFilter&lt;/filter-class&gt;
</span><span class='line'>        &lt;init-param&gt;
</span><span class='line'>            &lt;param-name&gt;casServerUrlPrefix&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;http://localhost:8080/cas&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param&gt;
</span><span class='line'>        &lt;init-param&gt;
</span><span class='line'>            &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param&gt;
</span><span class='line'>    &lt;/filter&gt;
</span><span class='line'>
</span><span class='line'>    &lt;filter-mapping&gt;
</span><span class='line'>        &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
</span><span class='line'>        &lt;url-pattern&gt;/protected/*&lt;/url-pattern&gt;
</span><span class='line'>    &lt;/filter-mapping&gt;
</span><span class='line'>
</span><span class='line'>    &lt;filter-mapping&gt;
</span><span class='line'>        &lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
</span><span class='line'>        &lt;url-pattern&gt;*&lt;/url-pattern&gt;
</span><span class='line'>    &lt;/filter-mapping&gt;
</span><span class='line'>
</span><span class='line'>&lt;/web-app&gt;</span></code></pre></td></tr></table></div></figure>


<p>e.g. ä½¿ç”¨ SAML 1.1</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
</span><span class='line'>&lt;web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
</span><span class='line'>  version="2.4"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;display-name&gt;CAS client demo : application&lt;/display-name&gt;
</span><span class='line'>
</span><span class='line'>  &lt;filter&gt;
</span><span class='line'>      &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
</span><span class='line'>      &lt;filter-class&gt;org.jasig.cas.client.authentication.Saml11AuthenticationFilter&lt;/filter-class&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;casServerLoginUrl&lt;/param-name&gt;
</span><span class='line'>          &lt;param-value&gt;http://localhost:8080/cas/login&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>          &lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;onlyFullyAuthenticated&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;true&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param&gt;
</span><span class='line'>  &lt;/filter&gt;
</span><span class='line'>
</span><span class='line'>  &lt;filter&gt;
</span><span class='line'>      &lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
</span><span class='line'>      &lt;filter-class&gt;org.jasig.cas.client.validation.Saml11TicketValidationFilter&lt;/filter-class&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;casServerUrlPrefix&lt;/param-name&gt;
</span><span class='line'>          &lt;param-value&gt;http://localhost:8080/cas&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;serverName&lt;/param-name&gt;
</span><span class='line'>          &lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>  &lt;/filter&gt;
</span><span class='line'>
</span><span class='line'>  &lt;filter-mapping&gt;
</span><span class='line'>      &lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
</span><span class='line'>      &lt;url-pattern&gt;/protected/*&lt;/url-pattern&gt;
</span><span class='line'>  &lt;/filter-mapping&gt;
</span><span class='line'>
</span><span class='line'>  &lt;filter-mapping&gt;
</span><span class='line'>      &lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
</span><span class='line'>      &lt;url-pattern&gt;*&lt;/url-pattern&gt;
</span><span class='line'>  &lt;/filter-mapping&gt;
</span><span class='line'>
</span><span class='line'>&lt;/web-app&gt;</span></code></pre></td></tr></table></div></figure>


<h2>é…ç½®å•ç‚¹ç™»å‡º Single Sign Out</h2>

<blockquote><p>! <em>SingleSignOutFilter</em> ä¼šå½±å“åˆ° character encodingã€‚å»ºè®®æ˜¾å¼åœ°é…ç½®ä¸‹ <a href="http://code.google.com/p/vt-middleware/wiki/vtservletfilters#CharacterEncodingFilter">VT Character Encoding Filter</a> æˆ– <a href="http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/web/filter/CharacterEncodingFilter.html">Spring Character Encoding Filter</a>ã€‚</p></blockquote>

<p>CAS å¯¹ Single Sign Out support çš„æ”¯æŒï¼Œæ¶‰åŠåˆ°å¯¹ä¸€ä¸ª filter å’Œä¸€ä¸ª ContextListener çš„é…ç½®ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœä»¥ Web filters çš„å½¢å¼ä¸º Java é…ç½® CAS Clientï¼Œç™»å‡ºçš„ filter éœ€è¦åœ¨å…¶ä»– filters å‰é¢ã€‚</p>

<p><strong>PS</strong>: Order of Required Filters <a href="https://wiki.jasig.org/display/CASC/CAS+Client+for+Java+3.1">å…¨æ–‡é“¾æ¥</a>
Order of Required Filters</p>

<p>How to configure the filters is described on the pages above. This section details the order in which the filters should appear:</p>

<ol>
<li>SingleLogOutFilter (if you&rsquo;re using it)</li>
<li>AuthenticationFilter</li>
<li>TicketValidationFilter (whichever one is chosen)</li>
<li>HttpServletRequestWrapperFilter</li>
<li>AssertionThreadLocalFilter</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;listenerclass&gt;
</span><span class='line'>  org.jasig.cas.client.session.SingleSignOutHttpSessionListener&lt;/listener-class&gt;
</span><span class='line'>&lt;/listener&gt;</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/12/05/note-special-things-about-cas/">
			
				NOTE: Special Things About CAS</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-12-05T02:49:00+00:00" pubdate data-updated="true">Dec 5<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<h1>1</h1>

<p><strong>Create the Certificate</strong></p>

<p>æ‰“å¼€ç»ˆç«¯ï¼Œè¿›åˆ° home ç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>keytool -genkey -alias tomcat -keyalg RSA -validity 365</span></code></pre></td></tr></table></div></figure>


<p>éœ€è¦è¾“å…¥ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Enter keystore password:
</span><span class='line'>Re-enter new password:
</span><span class='line'>What is your first and last name?
</span><span class='line'>  [Unknown]:  $REPLACE_WITH_FULL_MACHINE_NAME
</span><span class='line'>What is the name of your organizational unit?
</span><span class='line'>  [Unknown]:  Test
</span><span class='line'>What is the name of your organization?
</span><span class='line'>  [Unknown]:  Test
</span><span class='line'>What is the name of your City or Locality?
</span><span class='line'>  [Unknown]:  Test
</span><span class='line'>What is the name of your State or Province?
</span><span class='line'>  [Unknown]:  Test
</span><span class='line'>What is the two-letter country code for this unit?
</span><span class='line'>  [Unknown]:  US
</span><span class='line'>Is CN=$FULL_MACHINE_NAME, OU=Test, O=Test, L=Test, ST=Test, C=US correct?
</span><span class='line'>  [no]:  yes</span></code></pre></td></tr></table></div></figure>


<p>å¦‚ä½•ç»™è¿™äº›å€¼ï¼Ÿ</p>

<p>For the keystore password you should enter &ldquo;changeit&rdquo; without the quotation marks. When prompted for the first and last name, you should enter your machine name during development. The rest of the data does not matter. Then obviously answer &ldquo;yes&rdquo; to the question of whether it&rsquo;s correct.</p>

<blockquote><p>æ³¨æ„ï¼š CAS åè®®éœ€è¦èµ° HTTPSï¼Œä¸ºäº†ä¿è¯èƒ½å¤Ÿå·¥ä½œï¼Œ &ldquo;first and last name&rdquo; ä¸º $FULL_MACHINE_NAMEã€‚Mac ä¸Šè·å–è®¡ç®—æœºå…¨åçš„æ–¹æ³•æ˜¯ï¼š<code>scutil --get ComputerName</code> æˆ–è€… <code>scutil --get LocalHostName</code>ã€‚</p></blockquote>

<p>ä¸‹ä¸€æ­¥ï¼Œæ‰“å¼€ <code>$TOMCAT_HOME/conf/server.xml</code>ï¼Œæ‰¾åˆ°è¿™ä¸€å—ï¼Œå»æ‰æ³¨é‡Šå³å¯ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!--
</span><span class='line'>&lt;Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
</span><span class='line'>    maxThreads="150" scheme="https" secure="true"
</span><span class='line'>    clientAuth="false" sslProtocol="TLS" /&gt;
</span><span class='line'>--&gt;</span></code></pre></td></tr></table></div></figure>


<p>é‡å¯ Tomcatï¼Œè®¿é—®</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://$FULL_MACHINE_NAME:8443/</span></code></pre></td></tr></table></div></figure>


<p>Any application that wishes to securely connect to this Tomcat instance would need to import the certificate. You can export the certificate that&rsquo;s compatible with other JVM keystores by executing the following command:</p>

<p>æ‰€æœ‰æƒ³è®¿é—®è¯¥ Tomcat å®ä¾‹çš„åº”ç”¨éƒ½éœ€è¦å¯¼å…¥è¯ä¹¦ã€‚é¦–å…ˆå¯¼å‡ºè¯ä¹¦ï¼Œéœ€è¦è¾“å…¥ keystore çš„å¯†ç ï¼Œè¿™é‡Œå°±æ˜¯ changeitï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>keytool -export -alias tomcat -file server.crt</span></code></pre></td></tr></table></div></figure>


<p>è¾“å‡ºæ˜¯ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Enter keystore password:
</span><span class='line'>Certificate stored in file &lt;server.crt&gt;</span></code></pre></td></tr></table></div></figure>


<p>You can then import the server.crt into other JVM keystore&rsquo;s by executing a command similar to this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>keytool -import -file server.crt -keystore $JAVA_HOME/jre/lib/security/cacerts -alias tomcat</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s recommended that you add it to the JVM keystore of your local development machine to facilitate testing.</p>

<h1>2</h1>

<p><strong>Maven War Overlay</strong><sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p><a href="https://wiki.jasig.org/display/CASUM/Best+Practice+-+Setting+Up+CAS+Locally+using+the+Maven+WAR+Overlay+Method">Best Practice &ndash; Setting Up CAS Locally using the Maven WAR Overlay Method</a><a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/12/05/deploy-war-to-tomcat/">
			
				Deploy War to Tomcat</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-12-05T02:28:00+00:00" pubdate data-updated="true">Dec 5<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<p>éå¸¸ç®€å•ï¼Œ<code>mvn package</code> ç”Ÿæˆçš„ war åŒ…ï¼Œç›´æ¥æ‰”è¿› Tomcat å®‰è£…ç›®å½•ä¸‹çš„ webApps ç›®å½•ã€‚ç„¶åé‡å¯ä¸‹ Tomcatã€‚</p>

<p>ä¸éœ€è¦ä»»ä½•é¢å¤–çš„é…ç½®ï¼Œé»˜è®¤æ˜¯ localhost:8080/war_name/</p>

		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/12/04/note-writing-gnu-emacs-extensions/">
			
				NOTE: Writing GNU Emacs Extensions</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-12-04T11:59:00+00:00" pubdate data-updated="true">Dec 4<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<h1>1ï¿¼</h1>

<p><strong>åˆ—è¡¨å¤„ç†</strong></p>

<h2>1.1</h2>

<p><strong>Lisp åˆ—è¡¨</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'(rose
</span><span class='line'>  violet
</span><span class='line'>  daisy
</span><span class='line'>  buttercup)</span></code></pre></td></tr></table></div></figure>


<h3>1.1.1</h3>

<p><strong>Lisp åŸå­</strong></p>

<p><code>()</code> ç©ºåˆ—è¡¨</p>

<p>ç©ºåˆ—è¡¨æ—¢æ˜¯åŸå­ï¼Œä¹Ÿæ˜¯åˆ—è¡¨</p>

<p>åŸå­å’Œåˆ—è¡¨éƒ½å«åš <strong>ç¬¦å·è¡¨è¾¾å¼</strong>(symbolic expression)ï¼Œç®€ç§° s-expressionã€‚</p>

		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/11/30/emacs-help-command/">
			
				Emacs Help Command</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-11-30T03:30:00+00:00" pubdate data-updated="true">Nov 30<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<p>You have typed C-h, the help character.  Type a Help option:
(Use SPC or DEL to scroll through this text.  Type q to exit the Help command.)</p>

<p>å¸¸ç”¨çš„æ˜¯ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>a PATTERN   Show commands whose name matches the PATTERN (a list of words
</span><span class='line'>              or a regexp).  See also the `apropos' command.              
</span><span class='line'>b           Display all key bindings.
</span><span class='line'>c KEYS      Display the command name run by the given key sequence.
</span><span class='line'>C CODING    Describe the given coding system, or RET for current ones.
</span><span class='line'>d PATTERN   Show a list of functions, variables, and other items whose
</span><span class='line'>              documentation matches the PATTERN (a list of words or a regexp).
</span><span class='line'>e           Go to the *Messages* buffer which logs echo-area messages.
</span><span class='line'>f FUNCTION  Display documentation for the given function.
</span><span class='line'>F COMMAND   Show the on-line manual's section that describes the command.
</span><span class='line'>g           Display information about the GNU project.
</span><span class='line'>h           Display the HELLO file which illustrates various scripts.
</span><span class='line'>i           Start the Info documentation reader: read on-line manuals.
</span><span class='line'>I METHOD    Describe a specific input method, or RET for current.
</span><span class='line'>k KEYS      Display the full documentation for the key sequence.
</span><span class='line'>K KEYS      Show the on-line manual's section for the command bound to KEYS.
</span><span class='line'>l           Show last 300 input keystrokes (lossage).
</span><span class='line'>L LANG-ENV  Describes a specific language environment, or RET for current.
</span><span class='line'>m           Display documentation of current minor modes and current major mode,
</span><span class='line'>              including their special commands.
</span><span class='line'>n           Display news of recent Emacs changes.
</span><span class='line'>p TOPIC     Find packages matching a given topic keyword.
</span><span class='line'>r           Display the Emacs manual in Info mode.
</span><span class='line'>s           Display contents of current syntax table, plus explanations.
</span><span class='line'>S SYMBOL    Show the section for the given symbol in the on-line manual
</span><span class='line'>              for the programming language used in this buffer.
</span><span class='line'>t           Start the Emacs learn-by-doing tutorial.
</span><span class='line'>v VARIABLE  Display the given variable's documentation and value.
</span><span class='line'>w COMMAND   Display which keystrokes invoke the given command (where-is).
</span><span class='line'>.           Display any available local help at point in the echo area.
</span><span class='line'>
</span><span class='line'>C-a         Information about Emacs.
</span><span class='line'>C-c         Emacs copying permission (GNU General Public License).
</span><span class='line'>C-d         Instructions for debugging GNU Emacs.
</span><span class='line'>C-e         External packages and information about Emacs.
</span><span class='line'>C-f         Emacs FAQ.
</span><span class='line'>C-m         How to order printed Emacs manuals.
</span><span class='line'>C-n         News of recent Emacs changes.
</span><span class='line'>C-o         Emacs ordering and distribution information.
</span><span class='line'>C-p         Info about known Emacs problems.
</span><span class='line'>C-t         Emacs TODO list.
</span><span class='line'>C-w         Information on absence of warranty for GNU Emacs.
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/11/29/emacs-survial-with-evil-and-family/">
			
				Emacs Survial With Evil &amp; Family</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-11-29T23:33:00+00:00" pubdate data-updated="true">Nov 29<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<h1>1 æ¦‚è§ˆ</h1>

<h2>1.1 å®‰è£… evil</h2>

<p>ä»ç½‘ä¸Šæ‰¾åˆ°çš„ä¸€ä¸ªç®€æ˜“çš„æ–¹æ³•ï¼Œeasy to be understood:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(defun require-package (package)
</span><span class='line'>  "Install given PACKAGE."
</span><span class='line'>  (unless (package-installed-p package)
</span><span class='line'>    (unless (assoc package package-archive-contents)
</span><span class='line'>      (package-refresh-contents))
</span><span class='line'>    (package-install package)))</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(require-package 'evil)
</span><span class='line'>(require 'evil)
</span><span class='line'>(evil-mode 1)</span></code></pre></td></tr></table></div></figure>


<h2>1.2 modes and states</h2>

<p>å…‰æ ‡ä¸Šç”¨ç‚¹é¢œè‰²ï¼Œçœ‹èµ·æ¥èˆ’æœç‚¹ã€‚çº¢è‰²æ˜¯é€€å›Emacsï¼ˆä½¿ç”¨<code>C-z</code>ï¼Œå†æŒ‰ä¸€æ¬¡<code>C-z</code>å›åˆ°evilï¼‰ï¼Œ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(setq evil-emacs-state-cursor '("red" box))
</span><span class='line'>(setq evil-normal-state-cursor '("green" box))
</span><span class='line'>(setq evil-insert-state-cursor '("orange" bar))</span></code></pre></td></tr></table></div></figure>


<blockquote><p>è¿™é‡Œæœ‰ä¸ªterminologyçš„åŒºåˆ«ï¼švimä¸­çš„<em>mode</em>æŒ‡çš„æ˜¯Normal, Insert, Visualç­‰ï¼Œvimæ˜¯æ¨¡å¼ç¼–è¾‘å™¨ã€‚ä½†æ˜¯åœ¨Emacsä¸­ï¼Œ<em>mode</em>æ˜¯æŒ‡å¯¹ç‰¹å®šæ–‡æœ¬å®šä¹‰çš„ä¸€ç»„å¿«æ·é”®ã€‚æ‰€ä»¥ï¼ŒevilæŠŠvimä¸­çš„<em>mode</em>ç§°ä½œ<em>state</em>ã€‚</p></blockquote>

<h1>2 è®¾ç½®</h1>

<p>é€šè¿‡ä¸€å †variableè®¾ç½®evilï¼Œå¯ä»¥é€šè¿‡ <code>M-x customize-group RET evil RET</code> æŸ¥çœ‹å½“å‰çš„è®¾ç½®ã€‚</p>

<p><code>setq</code>è®¾ç½®å…¨å±€å˜é‡ï¼Œ<code>setq-default</code>è®¾ç½®buffer-localçš„å˜é‡ï¼Œè€Œä¸”è¦åœ¨evilåŠ è½½å‰ä¿®æ”¹<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(setq evil-shift-width 8) 
</span><span class='line'>;; Load Evil
</span><span class='line'>(require â€™evil) . . .</span></code></pre></td></tr></table></div></figure>


<p>ä¸‹é¢åˆ—å‡ºçš„variableï¼ŒåŸºæœ¬ä¸Šé»˜è®¤å€¼å’Œvimçš„è¡Œä¸ºç±»ä¼¼ï¼Œä½†æ˜¯<em>evil-want-C-u-scroll</em>é»˜è®¤ä¸æ˜¯tã€‚</p>

<p><em>evil-auto-indent</em> [Variable]</p>

<blockquote><p>t(default), nilï¼Œç±»ä¼¼vimä¸­çš„autoindentã€‚</p></blockquote>

<p><em>evil-shift-width</em> [Variable]</p>

<blockquote><p>The number of columns a line is shifted by the commands > and &lt;.</p></blockquote>

<p><em>evil-repeat-move-cursor</em> [Variable]</p>

<blockquote><p>å¦‚æœt(default)ï¼Œä½¿ç”¨<code>.</code>é‡å¤æ—¶å…‰æ ‡æ”¹å˜ä½ç½®ã€‚</p></blockquote>

<p><em>evil-find-skip-newlines</em> [Variable]</p>

<blockquote><p>å¦‚æœtï¼Œé‚£ä¹ˆ<em>f</em>ï¼Œ<em>F</em>ï¼Œ<em>t</em>ï¼Œ<em>T</em>ä¼šæŸ¥æ‰¾åˆ°å…¶ä»–è¡Œã€‚nil(default)ã€‚</p></blockquote>

<p><em>evil-move-cursor-back</em> [Variable]</p>

<blockquote><p>t(default)ï¼Œå’Œvimçš„è¡Œä¸ºç±»ä¼¼ï¼Œé€€å‡ºinsert stateæ—¶ï¼Œå…‰æ ‡å‰ç§»ä¸€æ ¼ã€‚</p></blockquote>

<p><em>evil-want-fine-undo</em> [Variable]</p>

<blockquote><p>If t, then a change-based action like cw may be undone in several steps. If nil (the default), then it is undone in one step.</p></blockquote>

<p><em>evil-regexp-search</em> [Variable]</p>

<blockquote><p>t(default)ï¼Œ<code>/</code>ï¼Œ<code>?</code>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</p></blockquote>

<p><em>evil-search-wrap</em> [Variable]</p>

<blockquote><p>t(default)ï¼Œ<code>/</code>ï¼Œ<code>?</code>æœç´¢æ˜¯åˆ°åº•åä»å¤´å†æœç´¢ã€‚</p></blockquote>

<p><em>evil-flash-delay</em> [Variable]</p>

<blockquote><p>The number of seconds to flash search matches when pressing n and N.</p></blockquote>

<p><em>evil-want-C-i-jump</em> [Variable]</p>

<blockquote><p>If t (the default), then C-i jumps forwards in the jump list. If nil, then C-i inserts a tab.</p></blockquote>

<p><em>evil-want-C-u-scroll</em> [Variable]</p>

<blockquote><p>If t, then C-u scrolls the buffer. If nil (the default), then C-u begins a numeric prefix argument.</p></blockquote>

<h2>2.1 The cursor</h2>

<p>è¿™ä¸ªä¹‹å‰ä¹Ÿå·²ç»æ¶‰åŠè¿‡ï¼Œç°åœ¨å…¨é¢äº†è§£ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(setq evil-emacs-state-cursor '("red" box))
</span><span class='line'>(setq evil-normal-state-cursor '("green" box))
</span><span class='line'>(setq evil-insert-state-cursor '("orange" bar))</span></code></pre></td></tr></table></div></figure>


<p>ä¸€å…±è¿™ä¹ˆå¤šï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>evil-default-cursor
</span><span class='line'>  The default cursor.
</span><span class='line'>evil-normal-state-cursor
</span><span class='line'>  The cursor for Normal state.
</span><span class='line'>evil-insert-state-cursor
</span><span class='line'>  The cursor for Insert state.
</span><span class='line'>evil-visual-state-cursor
</span><span class='line'>  The cursor for Visual state.
</span><span class='line'>evil-replace-state-cursor
</span><span class='line'>  The cursor for Replace state.
</span><span class='line'>evil-operator-state-cursor
</span><span class='line'>  The cursor for Operator-Pending state.
</span><span class='line'>evil-motion-state-cursor
</span><span class='line'>  The cursor for Motion state.
</span><span class='line'>evil-emacs-state-cursor
</span><span class='line'>  The cursor for Emacs state.</span></code></pre></td></tr></table></div></figure>


<h2>2.2 The initial state</h2>

<p>é»˜è®¤æ˜¯è¿›å…¥ Normal Stateã€‚æˆ‘ä¹Ÿå°±ä¸ä¿®æ”¹äº†ã€‚</p>

<h1>3 Keymaps</h1>

<p>Evil çš„é”®æ˜ å°„å­˜å‚¨åœ¨å¤šä¸ªkeymapsä¸­ï¼Œæ¯ä¸ª state æœ‰ä¸€ä¸ªå…¨å±€çš„ keymapï¼Œæ¯”å¦‚å¯¹åº”äºNormal State çš„<code>evil-normal-state-map</code>ã€‚
é€šè¿‡ Emacs çš„ <code>define-key</code> æ¥ä¿®æ”¹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>;; bind key "w" to command foo
</span><span class='line'>(define-key evil-normal-state-map "w" â€™foo)</span></code></pre></td></tr></table></div></figure>


<p><code>evil-maps.el</code> åŒ…å«æ‰€æœ‰çš„é”®ç»‘å®šã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>evil-normal-state-map
</span><span class='line'>  The global keymap for Normal state.
</span><span class='line'>evil-insert-state-map
</span><span class='line'>  The global keymap for Insert state.
</span><span class='line'>evil-visual-state-map
</span><span class='line'>  The global keymap for Visual state.
</span><span class='line'>evil-replace-state-map
</span><span class='line'>  The global keymap for Replace state.
</span><span class='line'>evil-operator-state-map
</span><span class='line'>  The global keymap for Operator-Pending state.
</span><span class='line'>evil-motion-state-map
</span><span class='line'>  The global keymap for Motion state.</span></code></pre></td></tr></table></div></figure>


<p>æ¯ä¸ª state è¿˜æœ‰ä¸€ä¸ª buffer-local çš„ keymapã€‚ä¹Ÿå°±æ˜¯ç‰¹å®šäºè¯¥ bufferï¼Œä¼˜å…ˆäº global keymapã€‚è¿™äº›å¯ä»¥é€šè¿‡ mode hook ä¿®æ”¹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>evil-normal-state-local-map
</span><span class='line'>  Buffer-local keymap for Normal state.
</span><span class='line'>evil-insert-state-local-map
</span><span class='line'>  Buffer-local keymap for Insert state.
</span><span class='line'>evil-visual-state-local-map
</span><span class='line'>  Buffer-local keymap for Visual state.
</span><span class='line'>evil-replace-state-local-map
</span><span class='line'>  Buffer-local keymap for Replace state.
</span><span class='line'>evil-operator-state-local-map
</span><span class='line'>  Buffer-local keymap for Operator-Pending state.
</span><span class='line'>evil-motion-state-local-map
</span><span class='line'>  Buffer-local keymap for Motion state.</span></code></pre></td></tr></table></div></figure>


<h2>3.1 â€˜evil-define-keyâ€™</h2>

<p>Evil æä¾›çš„æ–¹æ³•ï¼Œå¯ä»¥å¾€ Emacs çš„ keymap ä¸­æ·»åŠ ç‰¹å®š state çš„é”®ç»‘å®šã€‚æ¯”å¦‚:</p>

<p>å®šä¹‰äº†ä¸€ä¸ª minor modeï¼Œå«åš foo-modeã€‚ç„¶åå¾€è¯¥ mode çš„ normal state ä¸‹ä¿®æ”¹é”®ç»‘å®šã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(define-minor-mode foo-mode
</span><span class='line'>       "Foo mode."
</span><span class='line'>       :keymap (make-sparse-keymap))
</span><span class='line'>     (evil-define-key â€™normal foo-mode-map "w" â€™bar)
</span><span class='line'>     (evil-define-key â€™normal foo-mode-map "e" â€™baz)</span></code></pre></td></tr></table></div></figure>


<p>ç„¶åç”¨ hookï¼Œæ·»åŠ åˆ° text-mode-hook é‡Œã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(add-hook â€™text-mode-hook â€™foo-mode) ; enable alongside text-mode</span></code></pre></td></tr></table></div></figure>


<h2>Appendix 1</h2>

<p>ä»€ä¹ˆæ˜¯ vim çš„ magicï¼Ÿ</p>

<p>ä¸»è¦æ¶‰åŠåˆ°æ­£åˆ™è¡¨è¾¾å¼ã€‚å…ˆç•™å‡ ä¸ªå‚è€ƒèµ„æ–™ï¼š</p>

<ol>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/pattern.html#/magic">vimdoc</a></li>
<li><a href="http://vim.wikia.com/wiki/Simplifying_regular_expressions_using_magic_and_no-magic">vim.vikia</a></li>
</ol>


<p><strong>To Be Continued</strong></p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Strictly speaking, the order only matters if the variable affects the way Evil is loaded. This is the case with some of the â€˜evil-want-â€™ variables.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>


		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/11/29/linux-useful-tricks/">
			
				Linux Useful Tricks</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-11-29T08:18:00+00:00" pubdate data-updated="true">Nov 29<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<h2>è¯¾åä»»åŠ¡</h2>

<p>ä½¿ç”¨vagrantæ­å»ºLinuxè™šæ‹Ÿæœº</p>

<p><a href="http://docs.vagrantup.com/v2/getting-started/index.html">å®˜æ–¹ç½‘å€</a></p>

<p>1 é¦–å…ˆå®‰è£… <a href="http://www.virtualbox.org/">virtualbox</a></p>

<p>2 å®‰è£…<a href="http://docs.vagrantup.com/v2/installation/">vagrant</a></p>

<p>3 æ‰“å¼€cmdï¼Œæˆ–è€…ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ³¨æ„è¿™ä¸€æ­¥ä¼šä¸‹è½½ä¸€ä¸ªLinuxå‘è¡Œç‰ˆï¼Œå¤§çº¦3ï¼Œ400Må§ã€‚æ‰€ä»¥ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨è¿…é›·åˆ°ç½‘ä¸Šä¸‹è½½ä¸‹æ¥ï¼Œç„¶åæŠŠ <code>http://files.vagrantup.com/precise32.box</code> æ”¹æˆä½ æ–‡ä»¶çš„è·¯å¾„ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯<code>file:///Users/pieux/Documents/o/precise32.box</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant init precise32 http://files.vagrantup.com/precise32.box
</span><span class='line'>$ vagrant up</span></code></pre></td></tr></table></div></figure>


<p>4 SSH è¿›å…¥linuxå§ï¼<code>vagrant ssh</code>ï¼Œé€€å‡ºå°±æ˜¯ <code>exit</code></p>

<p>5 å…³é—­Linuxçš„å‘½ä»¤æ˜¯ï¼Œä¼‘çœ <code>vagrant suspend</code>ï¼Œæˆ–è€…å…³é—­<code>vagrant halt</code>ã€‚</p>

<h2>man å‘½ä»¤</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1    ä½¿ç”¨è€…åœ¨shellä¸­å¯ä»¥æ“ä½œçš„æŒ‡ä»¤æˆ–å¯æ‰§è¡Œæ¡£
</span><span class='line'>2 ç³»çµ±æ ¸å¿ƒå¯å‘¼å«çš„å‡½æ•°ä¸å·¥å…·ç­‰
</span><span class='line'>3 ä¸€äº›å¸¸ç”¨çš„å‡½æ•°(function)ä¸å‡½æ•°åº“(library)ï¼Œå¤§éƒ¨åˆ†æ˜¯Cçš„å‡½æ•°åº“(libc)
</span><span class='line'>4 è£…ç½®æ¡£æ¡ˆçš„è¯´æ˜ï¼Œé€šå¸¸åœ¨/devä¸‹çš„æ¡£æ¡ˆ
</span><span class='line'>5 è®¾å®šæ¡£æˆ–è€…æ˜¯æŸäº›æ¡£æ¡ˆçš„æ ¼å¼
</span><span class='line'>6 æ¸¸æˆ(games)
</span><span class='line'>7 æƒ¯ä¾‹ä¸åå®šç­‰ï¼Œä¾‹å¦‚Linuxæ¡£æ¡ˆç³»ç»Ÿã€ç½‘ç»œåå®šã€ASCII codeç­‰ç­‰çš„èªªæ˜
</span><span class='line'>8 ç³»çµ±ç®¡ç†å“¡å¯ç”¨çš„ç®¡ç†æŒ‡ä»¤
</span><span class='line'>9 è·Ÿkernelæœ‰å…³çš„æ–‡ä»¶</span></code></pre></td></tr></table></div></figure>


<h2>tree å‘½ä»¤</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tree
</span><span class='line'>-a
</span><span class='line'>-A
</span><span class='line'>-C
</span><span class='line'>man tree</span></code></pre></td></tr></table></div></figure>


<h1>shell å¿«æ·é”®</h1>

<p>ç¼–è¾‘å‘½ä»¤</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Ctrl + a ï¼šç§»åˆ°å‘½ä»¤è¡Œé¦–
</span><span class='line'>Ctrl + e ï¼šç§»åˆ°å‘½ä»¤è¡Œå°¾
</span><span class='line'>Ctrl + f ï¼šæŒ‰å­—ç¬¦å‰ç§»ï¼ˆå³å‘ï¼‰
</span><span class='line'>Ctrl + b ï¼šæŒ‰å­—ç¬¦åç§»ï¼ˆå·¦å‘ï¼‰
</span><span class='line'>Alt + f ï¼šæŒ‰å•è¯å‰ç§»ï¼ˆå³å‘ï¼‰
</span><span class='line'>Alt + b ï¼šæŒ‰å•è¯åç§»ï¼ˆå·¦å‘ï¼‰
</span><span class='line'>Ctrl + u ï¼šä»å…‰æ ‡å¤„åˆ é™¤è‡³å‘½ä»¤è¡Œé¦–
</span><span class='line'>Ctrl + k ï¼šä»å…‰æ ‡å¤„åˆ é™¤è‡³å‘½ä»¤è¡Œå°¾
</span><span class='line'>Ctrl + d ï¼šåˆ é™¤å…‰æ ‡å¤„çš„å­—ç¬¦
</span><span class='line'>Ctrl + y ï¼šç²˜è´´è‡³å…‰æ ‡å</span></code></pre></td></tr></table></div></figure>


<p>é‡æ–°æ‰§è¡Œå‘½ä»¤</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Ctrl + rï¼šé€†å‘æœç´¢å‘½ä»¤å†å²
</span><span class='line'>Ctrl + gï¼šä»å†å²æœç´¢æ¨¡å¼é€€å‡º
</span><span class='line'>Ctrl + pï¼šå†å²ä¸­çš„ä¸Šä¸€æ¡å‘½ä»¤
</span><span class='line'>Ctrl + nï¼šå†å²ä¸­çš„ä¸‹ä¸€æ¡å‘½ä»¤</span></code></pre></td></tr></table></div></figure>


<p>æ§åˆ¶å‘½ä»¤</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Ctrl + lï¼šæ¸…å±
</span><span class='line'>Ctrl + sï¼šé˜»æ­¢å±å¹•è¾“å‡º
</span><span class='line'>Ctrl + qï¼šå…è®¸å±å¹•è¾“å‡º
</span><span class='line'>Ctrl + cï¼šç»ˆæ­¢å‘½ä»¤
</span><span class='line'>Ctrl + zï¼šæŒ‚èµ·å‘½ä»¤</span></code></pre></td></tr></table></div></figure>


<h2>grep å‘½ä»¤</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>grep
</span><span class='line'>-v åé€‰
</span><span class='line'>-E æ­£åˆ™
</span><span class='line'>-i å¿½ç•¥å¤§å°å†™
</span><span class='line'>-n åŠ ä¸Šè¡Œå·</span></code></pre></td></tr></table></div></figure>


<p>ç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>^ è¡Œé¦–
</span><span class='line'>$ è¡Œå°¾
</span><span class='line'>. ä»»æ„å­—ç¬¦
</span><span class='line'>* &gt;0ä¸ªé‡å¤
</span><span class='line'>+ &gt;1ä¸ªé‡å¤
</span><span class='line'>[Gg], [A-Za-z]
</span><span class='line'>\&lt; å•è¯é¦–
</span><span class='line'>\&gt; å•è¯å°¾</span></code></pre></td></tr></table></div></figure>


<h2>è¿›ç¨‹ç›¸å…³</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ps -aux | grep process-name
</span><span class='line'>pgrep
</span><span class='line'>kill
</span><span class='line'>pkill
</span><span class='line'>killall</span></code></pre></td></tr></table></div></figure>


<h2>find</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>find -name
</span><span class='line'>find -not -name
</span><span class='line'>-i
</span><span class='line'>-type fdl
</span><span class='line'>-mindepth 3
</span><span class='line'>-maxdepth 3
</span><span class='line'>-exec ls -l {} \;
</span><span class='line'>| xargs ls -l</span></code></pre></td></tr></table></div></figure>


<h2>å…¶ä»–</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>touch åˆ›å»ºæ–‡ä»¶
</span><span class='line'>alias åˆ«å
</span><span class='line'>history
</span><span class='line'>sudo !! é‡æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤
</span><span class='line'>cd - è¿›å…¥ä¹‹å‰çš„ç›®å½•
</span><span class='line'>wc
</span><span class='line'>chmod 
</span><span class='line'>du -hd 1
</span><span class='line'>du -h --max-depth=1
</span><span class='line'>Ctrl-Z æŒ‚èµ·
</span><span class='line'>fg æ¢å¤
</span><span class='line'>&gt; .gitignore
</span><span class='line'>&lt; .gitignore
</span><span class='line'>mv filename.{old,new}
</span><span class='line'>rm !(*.foo|*.bar|*.baz)</span></code></pre></td></tr></table></div></figure>


<h2>git ç›¸å…³</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git add -A
</span><span class='line'>git reset --soft
</span><span class='line'>git reset --mixed
</span><span class='line'>git reset --hard</span></code></pre></td></tr></table></div></figure>


<h2>å­¦ä¹ èµ„æ–™æ¨è</h2>

<p><a href="http://www.commandlinefu.com/commands/tagged/800/commandfu">http://www.commandlinefu.com/commands/tagged/800/commandfu</a></p>

		
		
	</div>

</article>


    <article class="post">
	<header>
		<h2 class="title">
			
			<a href="/blog/2013/11/27/jruby-small-memos/">
			
				JRuby Small Memos</a>
		</h2>
		<div class="meta date">








  


<time datetime="2013-11-27T23:22:00+00:00" pubdate data-updated="true">Nov 27<span>th</span>, 2013</time></div>
	</header>
	<div class="entry-content">
		<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ jruby --version</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ jruby -e "puts 'This is a short program'"
</span><span class='line'>This is a short program</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ jirb
</span><span class='line'>irb(main):001:0&gt; ['Hello', 'world'].join ' '
</span><span class='line'>=&gt; "Hello world"
</span><span class='line'>irb(main):002:0&gt; "ybuRJ morf".reverse
</span><span class='line'>=&gt; ufrom JRuby"
</span><span class='line'>irb(main):003:0&gt;</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
</nav>
</div>
	<footer id="footer" class="inner"><br>
<br>
<br>
<br>
&copy; 2013

    Pieux Xi

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/hyphenator.js"></script>







</body>
<script>
  $(document).ready(function() {
  // Make images center
  $('p:has(img)').css('text-align', 'center');
  });
</script>
</html>
